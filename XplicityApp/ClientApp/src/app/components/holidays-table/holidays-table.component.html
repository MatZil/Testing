<div>
  <div class="columns">
    <button nz-button nzType="primary" style="float:left;" (click)=showModalCreator()>Request holidays</button>
    <mat-select *ngIf="isAdmin()" class="statusSelect" name="status" placeholder="Employee status"
            (selectionChange)="changeStatus()" [(value)]="selected">
            <mat-option [value]="1">
                Current employees
            </mat-option>
            <mat-option [value]="0">
                Former employees
            </mat-option>
        </mat-select>
    </div>
    <form #newClientForm="ngForm" class="client-input-form" (ngSubmit)="onSubmit(newClientForm)">
        <nz-modal [(nzVisible)]="isVisibleCreator" [nzTitle]="modalTitl" [nzContent]="modalConten"
            [nzFooter]="modalFoote" (nzOnCancel)="handleCancelCreator()">
            <ng-template #modalTitl>
                Request holidays
            </ng-template>
            <ng-template #modalConten>
                   <app-overtime-display></app-overtime-display>
                <mat-card>
                    <div class="columns">
                        <mat-form-field>
                            <mat-select [(ngModel)]="requestHolidays.type" name="type" placeholder="Holiday's type"
                                required #nameInput="ngModel" [(value)]="selectedType">
                                <mat-option [value]="0">Annual</mat-option>
                                <mat-option [value]="1"
                                    *ngIf="currentUser.currentAvailableLeaves > 0 || currentUser.nextMonthAvailableLeaves > 0">
                                    Parental
                                </mat-option>
                                <mat-option [value]="2">Science</mat-option>
                                <mat-error *ngIf="nameInput.invalid && (nameInput.dirty || nameInput.touched)"
                                    class="error">
                                    Type cannot be empty.
                                </mat-error>
                            </mat-select>
                        </mat-form-field>
                        <mat-form-field *ngIf="shouldDisplayOvertimeInput()">
                                <input matInput [(ngModel)]="requestHolidays.overtimeDays" type="number" min="0" max={{currentUser.overtimeDays}} 
                                    name="overtimeHours" placeholder="Overtime days" #nameInput="ngModel">
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field>
                            <input matInput [(ngModel)]="requestHolidays.fromInclusive" type="date" name="fromInclusive"
                                placeholder="Holidays from" required #nameInput="ngModel">
                            <mat-error *ngIf="nameInput.invalid && (nameInput.dirty || nameInput.touched)"
                                class="error">
                                Date cannot be empty.
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div>
                        <mat-form-field>
                            <input matInput [(ngModel)]="requestHolidays.toExclusive" type="date" name="toExclusive"
                                placeholder="Holidays to" required #nameInput="ngModel">
                            <mat-error *ngIf="nameInput.invalid && (nameInput.dirty || nameInput.touched)"
                                class="error">
                                Date cannot be empty.
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div *ngIf="selectedType == 0">
                        <mat-checkbox [checked]="requestHolidays.paid" (change)="changePaid()">Paid</mat-checkbox>
                    </div>
                </mat-card>
            </ng-template>

            <ng-template #modalFoote>
                <button nz-button nzType="default" (click)="handleCancelCreator()">Cancel</button>
                <button nz-button nzType="primary" (click)="setPaid(); onAddButtonClick(); handleOkCreator()"
                    [nzLoading]="isConfirmLoadingCreator" [disabled]="newClientForm.form.invalid">Request</button>
            </ng-template>
        </nz-modal>
    </form>
</div>

<div *ngIf="holidays">
  <nz-table #basicTable [nzData]="getHolidaysByRole()">
    <thead>
      <tr>
        <th *ngIf="isAdmin()">Employee</th>
        <th>Holidays type</th>
        <th>Paid</th>
        <th>Date from</th>
        <th>Date to</th>
        <th *ngIf="isAdmin()">Overtime hours</th>
        <th *ngIf="!isAdmin()">Overtime days</th>
        <th>Status</th>
        <th>Request creation date</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let hol of basicTable.data">
        <td *ngIf="isAdmin()">{{getUserNameById(hol.employeeId)}}</td>
        <td>{{enumConverter.determineHolidayType(hol.type)}}</td>
        <td>{{paidToString(hol.paid)}}</td>
        <td>{{hol.fromInclusive | date}}</td>
        <td>{{hol.toExclusive | date}}</td>
        <td>{{getOvertime(hol)}}</td>
        <td [style.color]="getStatusColor(hol.status)">{{getStatusName(hol.status)}}</td>
        <td>{{hol.requestCreatedDate | date}}</td>
      </tr>
    </tbody>
  </nz-table>
</div>
