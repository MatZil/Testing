<button nz-button nzType="primary" (click)=showModalCreator()>Add new employee</button>
<form #newClientForm="ngForm" class="client-input-form" (ngSubmit)="onSubmit(newClientForm)">
  <nz-modal [(nzVisible)]="isVisibleCreator" [nzTitle]="modalTitl" [nzContent]="modalConten" [nzFooter]="modalFoote"
            (nzOnCancel)="handleCancelCreator()" [nzStyle]="{'top': '0'}">
    <ng-template #modalTitl>
      Add new employee
    </ng-template>
    <ng-template #modalConten>
      <mat-card>
        <div class="columns">
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.name" type="text" name="name"
                     placeholder="Employee name" required #nameInput="ngModel" pattern="[a-zA-ZÄ…ÄÄ™Ä—Ä¯ÅÅ³Å«Å¾Ä„ÄŒÄ˜Ä–Ä®Å Å²ÅªÅ½]*">
              <mat-error *ngIf="nameInput.invalid" class="error">
                Please enter a valid name.
              </mat-error>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.surname" type="text" name="surname"
                     placeholder="Employee surname" required #surnameInput="ngModel" pattern="[a-zA-ZÄ…ÄÄ™Ä—Ä¯ÅÅ³Å«Å¾Ä„ÄŒÄ˜Ä–Ä®Å Å²ÅªÅ½]*">
              <mat-error *ngIf="surnameInput.invalid" class="error">
                Please enter a valid surname.
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="columns">
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.email" type="email" name="email"
                     placeholder="Employee email" #emailInput="ngModel" required email>
              <mat-error *ngIf="emailInput.invalid" class="error">
                Please enter a valid email.
              </mat-error>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.password" type="password" name="password"
                     placeholder="Employee password" required minlength="6" #passwordInput="ngModel">
              <mat-error *ngIf="passwordInput.errors?.required" class="error">
                Please enter password.
              </mat-error>
              <mat-error *ngIf="passwordInput.errors?.minlength" class="error">
                Enter at least 6 symbols.
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="columns">
          <div>
            <mat-form-field>
              <mat-select [(ngModel)]="newUser.clientId" name="clientId" placeholder="Client">
                <mat-option [value]=null>No client</mat-option>
                <div *ngFor="let client of clients">
                  <mat-option [value]="client.id">{{client.companyName}}</mat-option>
                </div>
              </mat-select>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.worksFromDate" type="date" name="worksFromDate"
                     placeholder="Started working from date" required #workStartInput="ngModel">
              <mat-error *ngIf="workStartInput.invalid" class="error">
                Date cannot be empty.
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="columns">
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.birthdayDate" type="date" name="birthDayDate"
                     placeholder="Employee birthday date" required #birthdayInput="ngModel">
              <mat-error *ngIf="birthdayInput.invalid" class="error">
                Date cannot be empty.
              </mat-error>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.healthCheckDate" type="date" name="healthCheckDate"
                     placeholder="Employee health check-up date" required #healthInput="ngModel">
              <mat-error *ngIf="healthInput.invalid" class="error">
                Date cannot be empty.
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="columns">
          <div>
            <mat-form-field>
              <mat-select [(ngModel)]="newUser.daysOfVacation" name="daysOfVacation"
                          placeholder="Days of vacation" #daysInput="ngModel">
                <mat-option [value]="20">20</mat-option>
                <mat-option [value]="25">25</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field>
              <mat-select [(ngModel)]="newUser.parentalLeaveLimit" name="parentalLeaveLimit"
                          placeholder="Parental leave limit" #parentalInput="ngModel">
                <mat-option [value]="0">0</mat-option>
                <mat-option [value]="1">1</mat-option>
                <mat-option [value]="2">2</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
        <div class="columns">
          <div>
            <mat-form-field>
              <mat-select [(ngModel)]="newUser.role" name="role" placeholder="Employee role"
                          #roleInput="ngModel">
                <mat-option *ngFor="let role of roles" [value]="role.name">{{role.name}}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.position" type="text" name="position"
                     placeholder="Employee position" required #positionInput="ngModel">
              <mat-error *ngIf="positionInput.invalid" class="error">
                Position cannot be empty.
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="columns">
          <div>
            <mat-checkbox [(ngModel)]="newUser.IsManualHolidaysInput" name="IsManualHolidaysInput">
              Enter available holidays manually:
            </mat-checkbox>
          </div>
          <div *ngIf="newUser.IsManualHolidaysInput">
            <mat-form-field>
              <input matInput [(ngModel)]="newUser.freeWorkDays" type="number" step="0.1" name="freeWorkDays" placeholder="Employee holidays" />
            </mat-form-field>
          </div>
        </div>
      </mat-card>
    </ng-template>

    <ng-template #modalFoote>
      <button nz-button nzType="default" (click)="handleCancelCreator()">Cancel</button>
      <button nz-button nzType="primary" (click)="onAddButtonClick(newUser); newClientForm.resetForm()" [nzLoading]="isConfirmLoadingCreator"
              [disabled]="newClientForm.form.invalid">
        Add employee
      </button>
    </ng-template>
  </nz-modal>
</form>
<nz-modal [(nzVisible)]="isVisibleEquipmentModal" [nzTitle]="EquipmentModal" [nzContent]="EquipmentModalContent"
          [nzFooter]="EquipmentModalFooter" (nzOnCancel)="closeEquipmentModal()" nzWidth="1000">
  <ng-template #EquipmentModal>
    Equipment list
  </ng-template>
  <ng-template #EquipmentModalContent>
    <app-inventory-table [employeeId]="employeeIdForEquipment"></app-inventory-table>
  </ng-template>
  <ng-template #EquipmentModalFooter>
    <button nz-button nzType="default" (click)="closeEquipmentModal()">Close</button>
  </ng-template>
</nz-modal>
<nz-table #basicTable [nzData]="users" [nzScroll]="{x: '100%'}">
  <thead>
    <tr>
      <th>Name</th>
      <th nzCustomFilter>
        Surname
        <i class="ant-table-filter-icon" nz-icon nz-dropdown #dropdown="nzDropdown" nzType="search"
           [nzDropdownMenu]="menu" [class.ant-table-filter-open]="dropdown.nzVisible" nzTrigger="click"
           nzPlacement="bottomRight" [nzClickHide]="false" nzTableFilter></i>
      </th>
      <th>Client</th>
      <th>Works from</th>
      <th>Birthday date</th>
      <th>Days of vacation</th>
      <th>Free workdays left</th>
      <th>Overtime hours</th>
      <th>Email</th>
      <th>Position</th>
      <th>Parental leave limit</th>
      <th>Current available parental leaves</th>
      <th>Next month's parental leaves</th>
      <th>Health check-up date</th>
      <th>Status</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let user of basicTable.data">
      <td>{{user.name}}</td>
      <td>{{user.surname}}</td>
      <td>{{getClientName(user.clientId)}}</td>
      <td>{{user.worksFromDate | date}}</td>
      <td>{{user.birthdayDate | date}}</td>
      <td>{{user.daysOfVacation}}</td>
      <td>{{user.freeWorkDays | number : '.0-2'}}</td>
      <td>{{user.overtimeHours}}</td>
      <td>{{user.email}}</td>
      <td>{{user.position}}</td>
      <td>{{user.parentalLeaveLimit}}</td>
      <td>{{user.currentAvailableLeaves}}</td>
      <td>{{user.nextMonthAvailableLeaves}}</td>
      <td>{{user.healthCheckDate | date}}</td>
      <td>{{employeeStatus[user.status]}} employee</td>
      <td>
        <button nz-button nzType="primary"
                (click)="populateUserForm(user); setSelectedUserStatus(); showModalEditor(); populateUserFormNoId(user)">
          Edit
        </button>
      </td>
      <td>
        <button nz-button nzType="primary" (click)="showEquipmentModal(user.id)">Equipment</button>
      </td>
    </tr>
    <form #editUsersForm="ngForm" class="client-input-form" (ngSubmit)="onSubmit(editUsersForm)">
      <nz-modal [(nzVisible)]="isVisibleEditor" [nzTitle]="modalTitle" [nzContent]="modalContent"
                [nzFooter]="modalFooter" (nzOnCancel)="handleCancelEditor()" [nzStyle]="{'top': '0'}">
        <ng-template #modalTitle>
          Edit employee
        </ng-template>
        <ng-template #modalContent>
          <mat-card>
            <div class="columns">
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.name" type="text" name="name"
                         placeholder="Employee name" #nameInput="ngModel"
                         required pattern="[a-zA-ZÄ…ÄÄ™Ä—Ä¯ÅÅ³Å«Å¾Ä„ÄŒÄ˜Ä–Ä®Å Å²ÅªÅ½]*">
                  <mat-error *ngIf="nameInput.invalid" class="error">
                    Please enter a valid name.
                  </mat-error>
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.surname" type="text" name="surname"
                         placeholder="Employee surname" #surnameInput="ngModel"
                         required pattern="[a-zA-ZÄ…ÄÄ™Ä—Ä¯ÅÅ³Å«Å¾Ä„ÄŒÄ˜Ä–Ä®Å Å²ÅªÅ½]*">
                  <mat-error *ngIf="surnameInput.invalid" class="error">
                    Please enter a valid surname.
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
            <div class="columns">
              <div>
                <mat-form-field>
                  <mat-select [(ngModel)]="formDataUsersNoId.clientId" name="clientId"
                              placeholder="Client id">
                    <mat-option [value]=null>No client</mat-option>
                    <div *ngFor="let client of clients">
                      <mat-option [value]="client.id">{{client.companyName}}</mat-option>
                    </div>
                  </mat-select>
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.worksFromDate" type="date"
                         name="worksFromDate" placeholder="Started working from date" #workStartInput="ngModel"
                         required>
                  <mat-error *ngIf="workStartInput.invalid" class="error">
                    Date cannot be empty.
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
            <div class="columns">
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.birthdayDate" type="date"
                         name="birthDayDate" placeholder="Employee birthday date" #birthdayInput="ngModel"
                         required>
                  <mat-error *ngIf="birthdayInput.invalid" class="error">
                    Date cannot be empty.
                  </mat-error>
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.healthCheckDate" type="date"
                         name="healthCheckDate" placeholder="Employee health check-up date"
                         #healthInput="ngModel" required>
                  <mat-error *ngIf="healthInput.invalid" class="error">
                    Date cannot be empty.
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
            <div class="columns">
              <div>
                <mat-form-field>
                  <mat-select [(ngModel)]="formDataUsersNoId.daysOfVacation" name="daysOfVacation"
                              placeholder="Days of vacation" #daysInput="ngModel">
                    <mat-option [value]="20">20</mat-option>
                    <mat-option [value]="25">25</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <mat-select [(ngModel)]="formDataUsersNoId.parentalLeaveLimit"
                              name="parentalLeaveLimit" placeholder="Parental leave limit"
                              #parentalInput="ngModel">
                    <mat-option [value]="0">0</mat-option>
                    <mat-option [value]="1">1</mat-option>
                    <mat-option [value]="2">2</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            </div>
            <div class="columns">
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.freeWorkDays" type="number" step="0.01" name="freeWorkDays"
                         placeholder="Amount of holidays" #freeWorkDaysInput="ngModel">
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.overtimeHours" type="number" min="0"
                         name="overtimeHours" placeholder="Overtime hours" #overtimeInput="ngModel" required>
                  <mat-error *ngIf="overtimeInput.invalid" class="error">
                    Overtime hours cannot be empty.
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
            <div class="columns">
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.email" type="email" name="email"
                         placeholder="Employee email" #emailInput="ngModel" required email>
                  <mat-error *ngIf="emailInput.invalid" class="error">
                    Please enter a valid email.
                  </mat-error>
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <mat-select [(ngModel)]="formDataUsersNoId.status" name="status"
                              placeholder="Employee status" required #statusInput="ngModel" [(value)]="currentEmployeeStatus"
                              [disabled]="formDataUsers.id === getCurrentUserId()">
                    <mat-option [value]="0">
                      Former employee
                    </mat-option>
                    <mat-option [value]="1">
                      Current employee
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            </div>

            <div class="columns">
              <div>
                <mat-form-field>
                  <mat-select [(ngModel)]="formDataUsersNoId.role" name="role"
                              placeholder="Employee role" #roleInput="ngModel">
                    <mat-option *ngFor="let role of roles" [value]="role.name">
                      {{role.name}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div>
                <mat-form-field>
                  <input matInput [(ngModel)]="formDataUsersNoId.position" type="text" name="position"
                         placeholder="Employee position" #positionInput="ngModel" required>
                  <mat-error *ngIf="positionInput.invalid" class="error">
                    Position cannot be empty.
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </mat-card>
        </ng-template>

        <ng-template #modalFooter>
          <button nz-button nzType="default" (click)="handleCancelEditor()">Cancel</button>
          <button nz-button nzType="danger" (click)="showDeleteConfirm(formDataUsers.id)"
                  [disabled]="formDataUsers.id === getCurrentUserId()">
            Delete
          </button>
          <button nz-button nzType="primary"
                  (click)="isStatusChanged() ? showStatusConfirm() : onEditConfirmButtonClick(formDataUsersNoId, formDataUsers.id)"
                  [disabled]="editUsersForm.form.invalid">
            Confirm edit
          </button>
        </ng-template>
      </nz-modal>
    </form>
  </tbody>
</nz-table>

<nz-dropdown-menu #menu="nzDropdownMenu">
  <div class="search-box">
    <input type="text" nz-input placeholder="Search name" [(ngModel)]="searchValue" />
    <button nz-button nzSize="small" nzType="primary" (click)="search()" class="search-button">
      Search
    </button>
    <button nz-button nzSize="small" (click)="reset()">Reset</button>
  </div>
</nz-dropdown-menu>
